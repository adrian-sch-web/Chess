import './polyfills.server.mjs';
import{a as se,b as re,c as le,f as ae,l as ce}from"./chunk-EL53HFMY.mjs";import{Aa as B,Ba as v,Ca as T,Da as E,Ea as I,Fa as u,G as q,Ga as h,H as _,Ha as f,Ia as G,Ja as j,Ka as w,L as R,La as y,M as H,Ma as ie,Na as F,Oa as b,P as x,R as U,W as z,X as N,Y as k,cb as S,db as D,eb as oe,fa as W,ib as ne,la as C,ma as X,na as Y,oa as Z,pa as J,ra as ee,sa as te,ua as P,ya as M,za as A}from"./chunk-PXVXDLMY.mjs";var a=function(o){return o[o.Empty=0]="Empty",o[o.Pawn=1]="Pawn",o[o.Knight=2]="Knight",o[o.Bishop=3]="Bishop",o[o.Rook=4]="Rook",o[o.Queen=5]="Queen",o[o.King=6]="King",o}(a||{});function ye(o,i){o&1&&(k(),f(0,"circle",1))}function _e(o,i){o&1&&(k(),f(0,"circle",2))}function xe(o,i){o&1&&(k(),f(0,"path",3))}function be(o,i){o&1&&(k(),f(0,"path",4))}function Le(o,i){if(o&1&&M(0,xe,1,0,":svg:path",3)(1,be,1,0),o&2){let p=w();v(0,p.white?0:1)}}function Pe(o,i){o&1&&(k(),u(0,"g",5),f(1,"path",6)(2,"path",7)(3,"path",8)(4,"path",9),h())}function Se(o,i){o&1&&(k(),u(0,"g",5),f(1,"path",10)(2,"path",11)(3,"path",12)(4,"path",13)(5,"path",14),h())}function Re(o,i){if(o&1&&M(0,Pe,5,0,":svg:g",5)(1,Se,6,0),o&2){let p=w();v(0,p.white?0:1)}}function Te(o,i){o&1&&(k(),u(0,"g",15)(1,"g",16),f(2,"path",17)(3,"path",18)(4,"path",19),h(),f(5,"path",20),h())}function Ee(o,i){o&1&&(k(),u(0,"g",15)(1,"g",21),f(2,"path",17)(3,"path",18)(4,"path",19),h(),f(5,"path",22),h())}function Ie(o,i){if(o&1&&M(0,Te,6,0,":svg:g",15)(1,Ee,6,0),o&2){let p=w();v(0,p.white?0:1)}}function je(o,i){o&1&&(k(),u(0,"g",23),f(1,"path",24)(2,"path",25)(3,"path",26)(4,"path",27)(5,"path",28)(6,"path",29)(7,"path",30),h())}function Fe(o,i){o&1&&(k(),u(0,"g",31),f(1,"path",24)(2,"path",32)(3,"path",25)(4,"path",33)(5,"path",34)(6,"path",35)(7,"path",36)(8,"path",37)(9,"path",38)(10,"path",39)(11,"path",40),h())}function Ae(o,i){if(o&1&&M(0,je,8,0,":svg:g",23)(1,Fe,12,0),o&2){let p=w();v(0,p.white?0:1)}}function Be(o,i){o&1&&(k(),u(0,"g",41),f(1,"path",42)(2,"path",43)(3,"path",44)(4,"path",45)(5,"circle",46)(6,"circle",47)(7,"circle",48)(8,"circle",49)(9,"circle",50),h())}function Ke(o,i){o&1&&(k(),u(0,"g",51),f(1,"path",52)(2,"path",53)(3,"path",54)(4,"path",55)(5,"circle",46)(6,"circle",47)(7,"circle",48)(8,"circle",49)(9,"circle",50)(10,"path",56),u(11,"g",57),f(12,"path",58)(13,"path",59)(14,"path",60)(15,"path",61),h()())}function Oe(o,i){if(o&1&&M(0,Be,10,0,":svg:g",41)(1,Ke,16,0),o&2){let p=w();v(0,p.white?0:1)}}function Ve(o,i){o&1&&(k(),u(0,"g",62),f(1,"path",63)(2,"path",64)(3,"path",65)(4,"path",66),h())}function ze(o,i){o&1&&(k(),u(0,"g",67),f(1,"path",68)(2,"path",69)(3,"path",70)(4,"path",71)(5,"path",72)(6,"path",73),h())}function Ne(o,i){if(o&1&&M(0,Ve,5,0,":svg:g",62)(1,ze,7,0),o&2){let p=w();v(0,p.white?0:1)}}var pe=(()=>{let i=class i{constructor(){this.piece=a.Empty,this.white=!1,this.selected=!1,this.possibleMove=!1}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=x({type:i,selectors:[["app-piece"]],inputs:{piece:"piece",white:"white",selected:"selected",possibleMove:"possibleMove"},standalone:!0,features:[b],decls:9,vars:3,consts:[["width","100","height","100","viewBox","-3 0 50 50"],["cx","22","cy","25","r","25","fill","red"],["cx","22","cy","25","r","22","fill","orange",2,"opacity","0.7"],["xmlns","http://www.w3.org/2000/svg","d","m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",2,"opacity","1","fill","#ffffff","fill-opacity","1","fill-rule","nonzero","stroke","#000000","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","miter","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["xmlns","http://www.w3.org/2000/svg","d","m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",2,"opacity","1","fill","#000000","fill-opacity","1","fill-rule","nonzero","stroke","#000000","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","miter","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["xmlns","http://www.w3.org/2000/svg","transform","translate(0,0.3)",2,"opacity","1","fill","none","fill-opacity","1","fill-rule","evenodd","stroke","#000000","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["d","M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",2,"fill","#ffffff","stroke","#000000"],["d","M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",2,"fill","#ffffff","stroke","#000000"],["d","M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",2,"fill","#000000","stroke","#000000"],["d","M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z","transform","matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",2,"fill","#000000","stroke","#000000"],["d","M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",2,"fill","#000000","stroke","#000000"],["d","M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",2,"fill","#000000","stroke","#000000"],["d","M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",2,"fill","#ffffff","stroke","#ffffff"],["d","M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z","transform","matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",2,"fill","#ffffff","stroke","#ffffff"],["d","M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z ",2,"fill","#ffffff","stroke","none"],["xmlns","http://www.w3.org/2000/svg","transform","translate(0,0.6)",2,"opacity","1","fill","none","fill-rule","evenodd","fill-opacity","1","stroke","#000000","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],[2,"fill","#ffffff","stroke","#000000","stroke-linecap","butt"],["d","M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z"],["d","M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"],["d","M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"],["d","M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",2,"fill","none","stroke","#000000","stroke-linejoin","miter"],[2,"fill","#000000","stroke","#000000","stroke-linecap","butt"],["d","M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",2,"fill","none","stroke","#ffffff","stroke-linejoin","miter"],["xmlns","http://www.w3.org/2000/svg","transform","translate(0,0.3)",2,"opacity","1","fill","#ffffff","fill-opacity","1","fill-rule","evenodd","stroke","#000000","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["d","M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",2,"stroke-linecap","butt"],["d","M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",2,"stroke-linecap","butt"],["d","M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14",2,"stroke-linecap","butt"],["d","M 34,14 L 31,17 L 14,17 L 11,14"],["d","M 31,17 L 31,29.5 L 14,29.5 L 14,17",2,"stroke-linecap","butt","stroke-linejoin","miter"],["d","M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5"],["d","M 11,14 L 34,14",2,"fill","none","stroke","#000000","stroke-linejoin","miter"],["xmlns","http://www.w3.org/2000/svg","transform","translate(0,0.3)",2,"opacity","1","fill","#000000","fill-opacity","1","fill-rule","evenodd","stroke","#000000","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["d","M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z ",2,"stroke-linecap","butt"],["d","M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z ",2,"stroke-linecap","butt","stroke-linejoin","miter"],["d","M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z ",2,"stroke-linecap","butt"],["d","M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z ",2,"stroke-linecap","butt"],["d","M 12,35.5 L 33,35.5 L 33,35.5",2,"fill","none","stroke","#ffffff","stroke-width","1","stroke-linejoin","miter"],["d","M 13,31.5 L 32,31.5",2,"fill","none","stroke","#ffffff","stroke-width","1","stroke-linejoin","miter"],["d","M 14,29.5 L 31,29.5",2,"fill","none","stroke","#ffffff","stroke-width","1","stroke-linejoin","miter"],["d","M 14,16.5 L 31,16.5",2,"fill","none","stroke","#ffffff","stroke-width","1","stroke-linejoin","miter"],["d","M 11,14 L 34,14",2,"fill","none","stroke","#ffffff","stroke-width","1","stroke-linejoin","miter"],["xmlns","http://www.w3.org/2000/svg",2,"fill","#ffffff","stroke","#000000","stroke-width","1.5","stroke-linejoin","round"],["d","M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z"],["d","M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 11,36 11,36 C 9.5,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z"],["d","M 11.5,30 C 15,29 30,29 33.5,30",2,"fill","none"],["d","M 12,33.5 C 18,32.5 27,32.5 33,33.5",2,"fill","none"],["cx","6","cy","12","r","2"],["cx","14","cy","9","r","2"],["cx","22.5","cy","8","r","2"],["cx","31","cy","9","r","2"],["cx","39","cy","12","r","2"],["xmlns","http://www.w3.org/2000/svg",2,"fill","#000000","stroke","#000000","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["d","M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z",2,"stroke-linecap","butt","fill","#000000"],["d","m 9,26 c 0,2 1.5,2 2.5,4 1,1.5 1,1 0.5,3.5 -1.5,1 -1,2.5 -1,2.5 -1.5,1.5 0,2.5 0,2.5 6.5,1 16.5,1 23,0 0,0 1.5,-1 0,-2.5 0,0 0.5,-1.5 -1,-2.5 -0.5,-2.5 -0.5,-2 0.5,-3.5 1,-2 2.5,-2 2.5,-4 -8.5,-1.5 -18.5,-1.5 -27,0 z"],["d","M 11.5,30 C 15,29 30,29 33.5,30"],["d","m 12,33.5 c 6,-1 15,-1 21,0"],["d","M 11,38.5 A 35,35 1 0 0 34,38.5",2,"fill","none","stroke","#000000","stroke-linecap","butt"],[2,"fill","none","stroke","#ffffff"],["d","M 11,29 A 35,35 1 0 1 34,29"],["d","M 12.5,31.5 L 32.5,31.5"],["d","M 11.5,34.5 A 35,35 1 0 0 33.5,34.5"],["d","M 10.5,37.5 A 35,35 1 0 0 34.5,37.5"],["xmlns","http://www.w3.org/2000/svg","fill","none","fill-rule","evenodd","stroke","#000","stroke-linecap","round","stroke-linejoin","round","stroke-width","1.5"],["stroke-linejoin","miter","d","M22.5 11.63V6M20 8h5"],["fill","#fff","stroke-linecap","butt","stroke-linejoin","miter","d","M22.5 25s4.5-7.5 3-10.5c0 0-1-2.5-3-2.5s-3 2.5-3 2.5c-1.5 3 3 10.5 3 10.5"],["fill","#fff","d","M12.5 37c5.5 3.5 14.5 3.5 20 0v-7s9-4.5 6-10.5c-4-6.5-13.5-3.5-16 4V27v-3.5c-2.5-7.5-12-10.5-16-4-3 6 6 10.5 6 10.5v7"],["d","M12.5 30c5.5-3 14.5-3 20 0m-20 3.5c5.5-3 14.5-3 20 0m-20 3.5c5.5-3 14.5-3 20 0"],["xmlns","http://www.w3.org/2000/svg",2,"fill","none","fill-opacity","1","fill-rule","evenodd","stroke","#000000","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round","stroke-miterlimit","4","stroke-dasharray","none","stroke-opacity","1"],["d","M 22.5,11.63 L 22.5,6","id","path6570",2,"fill","none","stroke","#000000","stroke-linejoin","miter"],["d","M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",2,"fill","#000000","fill-opacity","1","stroke-linecap","butt","stroke-linejoin","miter"],["d","M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37",2,"fill","#000000","stroke","#000000"],["d","M 20,8 L 25,8",2,"fill","none","stroke","#000000","stroke-linejoin","miter"],["d","M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.5,26.6 L 22.5,24.5 C 20,18 10.85,14 6.97,19.85 C 4.5,25.5 13,29.5 13,29.5",2,"fill","none","stroke","#ffffff"],["d","M 12.5,30 C 18,27 27,27 32.5,30 M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5 M 12.5,37 C 18,34 27,34 32.5,37",2,"fill","none","stroke","#ffffff"]],template:function(t,s){if(t&1&&(k(),u(0,"svg",0),M(1,ye,1,0,":svg:circle",1)(2,_e,1,0,":svg:circle",2)(3,Le,2,1)(4,Re,2,1)(5,Ie,2,1)(6,Ae,2,1)(7,Oe,2,1)(8,Ne,2,1),h()),t&2){let n;C(),v(1,s.selected?1:-1),C(),v(2,s.possibleMove?2:-1),C(),v(3,(n=s.piece)===1?3:n===2?4:n===3?5:n===4?6:n===5?7:n===6?8:-1)}}});let o=i;return o})();var d=function(o){return o[o.Running=0]="Running",o[o.CheckMate=1]="CheckMate",o[o.StaleMate=2]="StaleMate",o[o.InsufficientMaterial=3]="InsufficientMaterial",o[o.MovesRule=4]="MovesRule",o[o.ThreeFoldRepitition=5]="ThreeFoldRepitition",o}(d||{});function Ge(o,i){if(o&1&&(u(0,"div"),y(1),h(),u(2,"div"),y(3),h()),o&2){let p=w();C(),F("",p.white?"White":"Black"," won due to Checkmate"),C(2),ie(p.white?"1-0":"0:1")}}function De(o,i){if(o&1&&(u(0,"div"),y(1),h(),u(2,"div"),y(3,"1/2-1/2"),h()),o&2){let p=w();C(),F("Draw due to ",p.Reason(),"")}}var me=(()=>{let i=class i{Reason(){switch(this.reason){case d.StaleMate:return"Stalemate";case d.InsufficientMaterial:return"Insufficient Material";case d.MovesRule:return"40 Moves Rule";case d.ThreeFoldRepitition:return"Three Fold Repitition"}return""}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=x({type:i,selectors:[["app-game-over"]],inputs:{white:"white",reason:"reason"},standalone:!0,features:[b],decls:2,vars:1,template:function(t,s){t&1&&M(0,Ge,4,2)(1,De,4,1),t&2&&v(0,s.reason==1?0:1)}});let o=i;return o})();var K=(()=>{let i=class i{constructor(){}kingInCheck(e,t,s){let n=s?-1:1,r=e.find(l=>l.type===a.King);if(r===void 0)return!0;for(let l of t)switch(l.type){case a.Pawn:if(Math.abs(l.position.column-r.position.column)===1&&r.position.row+n===l.position.row)return!0;break;case a.Knight:if(this.knightCheckTest(r,l))return!0;break;case a.Bishop:if(this.bishopCheckTest(r,l,[...e,...t]))return!0;break;case a.Rook:if(this.RookCheckTest(r,l,[...e,...t]))return!0;break;case a.Queen:if(this.bishopCheckTest(r,l,[...e,...t])||this.RookCheckTest(r,l,[...e,...t]))return!0;break;case a.King:if(Math.abs(r.position.row-l.position.row)<=1&&Math.abs(r.position.column-l.position.column)<=1)return!0;break}return!1}knightCheckTest(e,t){let s=t.position.row,n=t.position.column,r=e.position.row,l=e.position.column;return s===r+1&&t.position.row===e.position.row+2||s===r+1&&n===l-2||s===r-1&&n===l+2||s===r-1&&n===l-2||s===r+2&&n===l+1||s===r+2&&n===l-1||s===r-2&&n===l+1||s===r-2&&n===l-1}bishopCheckTest(e,t,s){if(Math.abs(e.position.row-t.position.row)===Math.abs(e.position.column-t.position.column)){let n=t.position.row-e.position.row,r=t.position.column-e.position.column;for(let l=1;l<Math.abs(n);l++)if(s.some(m=>e.position.row+l*Math.sign(n)===m.position.row&&e.position.column+l*Math.sign(r)===m.position.column))return!1;return!0}return!1}RookCheckTest(e,t,s){if(e.position.row===t.position.row||e.position.column===t.position.column){let n=t.position.row-e.position.row,r=t.position.column-e.position.column;for(let l=1;l<Math.max(Math.abs(n),Math.abs(r));l++)if(s.some(m=>e.position.row+l*Math.sign(n)===m.position.row&&e.position.column+l*Math.sign(r)===m.position.column))return!1;return!0}return!1}insufficienMaterialCheck(e){return e.length>2?!1:e.length===1||e.findIndex(t=>t.type===a.Knight)!==-1||e.findIndex(t=>t.type===a.Bishop)!==-1}getFEN(e,t){let s="";for(let n=0;n<e[0].length;n++)for(let r=0;r<e.length;r++)switch(e[r][n].piece){case a.Empty:s+="e";break;case a.Pawn:s+=e[r][n].white?"P":"p";break;case a.Knight:s+=e[r][n].white?"N":"n";break;case a.Bishop:s+=e[r][n].white?"B":"b";break;case a.Rook:s+=e[r][n].white?"R":"r";break;case a.Queen:s+=e[r][n].white?"Q":"q";break;case a.King:s+=e[r][n].white?"K":"k";break}return s+=t?"w":"b",s}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=_({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var ue=(()=>{let i=class i{constructor(e){this.check=e}getPossibleMoves(e,t,s,n,r,l){return this.allPotentialMoves(e,t,s,r,l).filter(c=>e.type!==a.King||Math.abs(c.position.column-e.position.column)<2?!this.check.kingInCheck([...s,{position:c.position,moved:!0,type:e.type}],n.filter(g=>c.position.row!==g.position.row||c.position.column!==g.position.column),r):!this.check.kingInCheck([...s,e],n,r)&&!this.check.kingInCheck([...s,{position:{row:e.position.row,column:e.position.column+Math.sign(c.position.column-e.position.column)},moved:!0,type:e.type}],n,r)&&!this.check.kingInCheck([...s,{position:c.position,moved:!0,type:e.type}],n,r))}allPotentialMoves(e,t,s,n,r){let l=[];switch(e.type){case a.Pawn:l=this.pawnMove(e,t,n,r);break;case a.Knight:l=this.knightMove(e,t,n);break;case a.Bishop:l=this.bishopMove(e,t,n);break;case a.Rook:l=this.rookMove(e,t,n);break;case a.Queen:l=this.queenMove(e,t,n);break;case a.King:l=this.kingMove(e,t,s,n);break}return l}pawnMove(e,t,s,n){let r=[],l=s?-1:1,m=e.position.row,c=e.position.column;return t[m+l][c].piece===a.Empty&&(r.push(t[m+l][c]),!e.moved&&t[m+2*l][c].piece===a.Empty&&r.push(t[m+2*l][c])),c<7&&t[m+l][c+1].piece!==a.Empty&&t[m+l][c+1].white!==s&&r.push(t[m+l][c+1]),c>0&&t[m+l][c-1].piece!==a.Empty&&t[m+l][c-1].white!==s&&r.push(t[m+l][c-1]),n?.row===m&&Math.abs(n.column-c)===1&&r.push(t[n.row+l][n.column]),r}knightMove(e,t,s){let n=[],r=[],l=e.position.row,m=e.position.column;r.push({row:l+1,column:m+2}),r.push({row:l+1,column:m-2}),r.push({row:l+2,column:m+1}),r.push({row:l+2,column:m-1}),r.push({row:l-1,column:m+2}),r.push({row:l-1,column:m-2}),r.push({row:l-2,column:m+1}),r.push({row:l-2,column:m-1}),r=r.filter(c=>this.inField(c.row,c.column));for(let c of r)(t[c.row][c.column].piece===a.Empty||t[c.row][c.column].white!==s)&&n.push(t[c.row][c.column]);return n}bishopMove(e,t,s){let n=[];return n.push(...this.straightLineMoves(t,e.position,1,1,s)),n.push(...this.straightLineMoves(t,e.position,1,-1,s)),n.push(...this.straightLineMoves(t,e.position,-1,1,s)),n.push(...this.straightLineMoves(t,e.position,-1,-1,s)),n}rookMove(e,t,s){let n=[];return n.push(...this.straightLineMoves(t,e.position,-1,0,s)),n.push(...this.straightLineMoves(t,e.position,1,0,s)),n.push(...this.straightLineMoves(t,e.position,0,-1,s)),n.push(...this.straightLineMoves(t,e.position,0,1,s)),n}queenMove(e,t,s){return[...this.bishopMove(e,t,s),...this.rookMove(e,t,s)]}kingMove(e,t,s,n){let r=[],l=e.position.row,m=e.position.column;for(let c=-1;c<2;c++)for(let g=-1;g<2;g++)if(!(c===0&&g===0)&&this.inField(l+c,m+1)&&(t[l+c][m+g].piece===a.Empty||t[l+c][m+g].white===!n)){r.push(t[l+c][m+g]);continue}if(!e.moved){let c=s.filter(g=>g.type===a.Rook);for(let g of c){if(g.moved)continue;let $=!0,O=(g.position.column-m)/Math.abs(g.position.column-m);for(let V=e.position.column+O;V!==g.position.column;V+=O)t[e.position.row][V].piece!==a.Empty&&($=!1);$&&r.push(t[e.position.row][e.position.column+2*O])}}return r}straightLineMoves(e,t,s,n,r){let l=[];for(let m=1;this.inField(t.row+m*s,t.column+m*n);m++){if(e[t.row+m*s][t.column+m*n].piece===a.Empty){l.push(e[t.row+m*s][t.column+m*n]);continue}e[t.row+m*s][t.column+m*n].white!==r&&l.push(e[t.row+m*s][t.column+m*n]);break}return l}inField(e,t){return e>=0&&e<=7&&t>=0&&t<=7}startPosition(e){let t=[];for(let s=0;s<8;s++)t.push({position:{column:s,row:e?6:1},moved:!1,type:a.Pawn});return t.push({position:{column:0,row:e?7:0},moved:!1,type:a.Rook}),t.push({position:{column:1,row:e?7:0},moved:!1,type:a.Knight}),t.push({position:{column:2,row:e?7:0},moved:!1,type:a.Bishop}),t.push({position:{column:3,row:e?7:0},moved:!1,type:a.Queen}),t.push({position:{column:4,row:e?7:0},moved:!1,type:a.King}),t.push({position:{column:5,row:e?7:0},moved:!1,type:a.Bishop}),t.push({position:{column:6,row:e?7:0},moved:!1,type:a.Knight}),t.push({position:{column:7,row:e?7:0},moved:!1,type:a.Rook}),t}};i.\u0275fac=function(t){return new(t||i)(R(K))},i.\u0275prov=_({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var fe=(()=>{let i=class i{constructor(){}cellName(e){return this.columnLetter(e.column)+(8-e.row)}columnLetter(e){return String.fromCharCode(97+e)}letter(e){switch(e){case a.Knight:return"N";case a.Bishop:return"B";case a.Rook:return"R";case a.Queen:return"Q";case a.King:return"K";default:return""}}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=_({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var de=(()=>{let i=class i{constructor(e,t,s){this.check=e,this.moves=t,this.notation=s,this.whitePieces=P(this.moves.startPosition(!0)),this.blackPieces=P(this.moves.startPosition(!1)),this.selectedCell=P(void 0),this.whitesTurn=P(!0),this.movesSinceChange=P(0),this.boardStates=P(new Map().set("rpeeeePRnpeeeePNbpeeeePBqpeeeePQkpeeeePKbpeeeePBnpeeeePNrpeeeePRw",1)),this.turnCount=0,this.pgn="",this.playerPieces=S(()=>this.whitesTurn()?this.whitePieces():this.blackPieces()),this.opponentPieces=S(()=>this.whitesTurn()?this.blackPieces():this.whitePieces()),this.state=S(()=>{if(this.possibleMoves().size===0)return this.check.kingInCheck(this.playerPieces(),this.opponentPieces(),this.whitesTurn())?d.CheckMate:d.StaleMate;if(this.movesSinceChange()>=80)return d.MovesRule;for(var n of this.boardStates().values())if(n===3)return d.ThreeFoldRepitition;return this.check.insufficienMaterialCheck(this.whitePieces())&&this.check.insufficienMaterialCheck(this.blackPieces())?d.InsufficientMaterial:d.Running}),this.possibleMoves=S(()=>{let n=new Map;for(let r of this.playerPieces()){let l=this.moves.getPossibleMoves(r,this.board(),this.playerPieces().filter(m=>m.position.row!==r.position.row||m.position.column!==r.position.column),this.opponentPieces(),this.whitesTurn(),this.enPassent);l.length>0&&n.set(this.board()[r.position.row][r.position.column],l)}return n}),this.selectedPossibleMoves=S(()=>{let n,r=this.selectedCell();return r!==void 0&&(n=this.possibleMoves().get(this.board()[r.row][r.column])),n!==void 0?n:[]}),this.board=S(()=>{let n=[];for(let r=0;r<8;r++){n.push([]);for(let l=0;l<8;l++)n[r].push({position:{row:r,column:l},piece:a.Empty,white:!1})}for(let r of this.whitePieces())n[r.position.row][r.position.column]={position:r.position,piece:r.type,white:!0};for(let r of this.blackPieces())n[r.position.row][r.position.column]={position:r.position,piece:r.type,white:!1};return n}),D(()=>{this.whitesTurn()&&this.turnCount++,this.pgnAddCheck()}),D(()=>{switch(this.state()){case d.CheckMate:this.pgn+="#",this.pgn+=this.whitesTurn()?" 0-1":" 1-0";break;case d.StaleMate:case d.ThreeFoldRepitition:case d.MovesRule:case d.InsufficientMaterial:this.pgn+=" 1/2-1/2"}})}promote(e){let t=this.selectedCell(),s={row:this.whitesTurn()?0:7,column:this.promoteColumn};this.enPassent=void 0,this.pgn+=" "+(this.whitesTurn()?this.turnCount+".":"")+(t.column!==s.column?this.notation.columnLetter(t.column)+"x":"")+this.notation.cellName(s)+"="+this.notation.letter(e),this.executeMove(t,s,e),this.promoteColumn=void 0,this.selectedCell.set(void 0),this.whitesTurn.update(n=>!n)}move(e,t){this.enPassent=void 0,this.board()[e.row][e.column].piece===a.Pawn&&(Math.abs(t.row-e.row)!==1&&(this.enPassent=t),e.column!==t.column&&this.board()[t.row][t.column].piece===a.Empty&&(this.whitesTurn()?this.blackPieces.update(s=>[...s.filter(n=>n.position.row!==e.row||n.position.column!==t.column)]):this.whitePieces.update(s=>[...s.filter(n=>n.position.row!==e.row||n.position.column!==t.column)]))),this.pgn+=this.createPgn(e,t,this.board()[e.row][e.column].piece),this.executeMove(e,t,this.board()[e.row][e.column].piece),this.selectedCell.set(void 0),this.whitesTurn.update(s=>!s),this.saveBoardState()}executeMove(e,t,s){let n=this.playerPieces().filter(c=>c.position.row!==e.row||c.position.column!==e.column),r=this.opponentPieces().filter(c=>c.position.row!==t.row||c.position.column!==t.column),l=s===a.King&&Math.abs(e.column-t.column)>1;if(s===a.Empty)return;let m=this.playerPieces().find(c=>c.position.row===e.row&&c.position.column===e.column);m&&m?.type===a.Pawn||(m?.type===a.King||m?.type===a.Rook)&&!m.moved||this.board()[t.row][t.column].piece!==a.Empty?(m?.type===a.King&&n.forEach(c=>{c.type===a.Rook&&(c.moved=!0)}),m?.type===a.Rook&&n.filter(c=>c.type===a.Rook&&!c.moved).length==0&&n.forEach(c=>{c.type===a.King&&(c.moved=!0)}),this.movesSinceChange.set(1),this.boardStates.set(new Map)):this.movesSinceChange.update(c=>c+1),n.push({position:t,moved:!0,type:s}),l&&(e.column>t.column?(n=n.filter(c=>c.position.row!==t.row||c.position.column!==0),n.push({position:{row:t.row,column:t.column+1},type:a.Rook,moved:!0})):(n=n.filter(c=>c.position.row!==t.row||c.position.column!==7),n.push({position:{row:t.row,column:t.column-1},type:a.Rook,moved:!0}))),this.whitePieces.set(this.whitesTurn()?n:r),this.blackPieces.set(this.whitesTurn()?r:n)}select(e){if(this.state()===d.Running){if(this.selectedCell()!==void 0&&this.selectedPossibleMoves().indexOf(e)!==-1){if(this.board()[this.selectedCell().row][this.selectedCell().column].piece===a.Pawn&&(e.position.row===0||e.position.row===7)){this.promoteColumn=e.position.column;return}this.move(this.selectedCell(),e.position);return}this.promoteColumn=void 0,this.selectedCell.set(e.position)}}createPgn(e,t,s){return" "+(this.whitesTurn()?this.turnCount+".":"")+(s===a.King&&t.column-e.column>1?"O-O":s===a.King&&e.column-t.column>1?"O-O-O":(s===a.Pawn?e.column!==t.column?this.notation.columnLetter(e.column)+"x":"":this.notation.letter(s)+this.solveAmbiguity(e,t,s)+(this.board()[t.row][t.column].piece===a.Empty?"":"x"))+this.notation.cellName(t))}solveAmbiguity(e,t,s){let n=this.playerPieces().filter(m=>m.type===s);return n=n.filter(m=>this.moves.getPossibleMoves(m,this.board(),this.playerPieces().filter(c=>c.position.row!==m.position.row||c.position.column!==m.position.column),this.opponentPieces(),this.whitesTurn(),this.enPassent).some(c=>c.position.row===t.row&&c.position.column===t.column)),n.length===1?"":n.filter(m=>m.position.column===e.column).length===1?this.notation.columnLetter(e.column):n.filter(m=>m.position.row===e.row).length===1?""+(8-e.row):this.notation.cellName(e)}pgnAddCheck(){this.state()!==d.CheckMate&&this.check.kingInCheck(this.playerPieces(),this.opponentPieces(),this.whitesTurn())&&(this.pgn+="+")}saveBoardState(){let e=this.check.getFEN(this.board(),this.whitesTurn());this.boardStates().has(e)?this.boardStates.update(t=>t.set(e,t.get(e)+1)):this.boardStates.update(t=>t.set(e,1))}restart(){this.whitePieces.set(this.moves.startPosition(!0)),this.blackPieces.set(this.moves.startPosition(!1)),this.selectedCell.set(void 0),this.whitesTurn.set(!0),this.movesSinceChange.set(0),this.boardStates.set(new Map().set("rpeeeePRnpeeeePNbpeeeePBqpeeeePQkpeeeePKbpeeeePBnpeeeePNrpeeeePRw",1)),this.enPassent=void 0,this.promoteColumn=void 0,this.turnCount=0,this.pgn=""}};i.\u0275fac=function(t){return new(t||i)(R(K),R(ue),R(fe))},i.\u0275prov=_({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();function He(o,i){if(o&1){let p=G();u(0,"button",2),j("click",function(){let t=z(p).$implicit,s=w();return N(s.promote(t))}),f(1,"app-piece",7),h()}if(o&2){let p=i.$implicit,e=w();C(),A("piece",p)("white",e.whitesTurn())}}function Ue(o,i){if(o&1){let p=G();u(0,"div",9),j("click",function(){let t=z(p).$implicit,s=w(2);return N(s.select(t))}),f(1,"app-piece",10),h()}if(o&2){let p,e=i.$implicit,t=i.$index,s=w().$index,n=w();B("background-color",s%2==t%2?"white":"grey"),C(),A("piece",e.piece)("white",e.white)("selected",((p=n.selectedCell())==null?null:p.row)==e.position.row&&((p=n.selectedCell())==null?null:p.column)==e.position.column&&n.selectedPossibleMoves().length>0)("possibleMove",n.selectedPossibleMoves().indexOf(e)!=-1)}}function We(o,i){if(o&1&&(u(0,"div",4),E(1,Ue,2,6,"div",8,T),h()),o&2){let p=i.$implicit;C(),I(p)}}function Xe(o,i){if(o&1&&f(0,"app-game-over",11),o&2){let p=w();A("white",p.whitesTurn())("reason",p.state())}}function Ye(o,i){if(o&1&&(u(0,"div"),y(1),h()),o&2){let p=i.$implicit,e=i.$index,t=w();B("grid-row",t.pgnMoveRow(e)),C(),F(" ",p," ")}}var Ce=(()=>{let i=class i{constructor(e){this.game=e,this.flip=!1,this.promotePieces=[5,4,3,2]}whitesTurn(){return this.game.whitesTurn()}board(){let e=this.game.board();if(this.flip){let t=[];for(let s=7;s>=0;s--){t.push([]);for(let n=7;n>=0;n--)t[7-s].push(e[s][n])}return t}return e}promoteColumn(){return this.game.promoteColumn}selectedCell(){return this.game.selectedCell()}selectedPossibleMoves(){return this.game.selectedPossibleMoves()}state(){return this.game.state()}promote(e){this.game.promote(e)}select(e){this.game.select(e)}restart(){this.game.restart()}pgnMoveRow(e){return Math.ceil(e/2)}getPgnSplit(){return this.game.pgn.split(" ")}boardStates(){return this.game.boardStates()}};i.\u0275fac=function(t){return new(t||i)(X(de))},i.\u0275cmp=x({type:i,selectors:[["app-board"]],standalone:!0,features:[b],decls:19,vars:5,consts:[[1,"board-container"],[1,"promote"],[3,"click"],[1,"board"],[1,"row"],[1,"moves-container"],[1,"moves"],[3,"piece","white"],[1,"cell"],[1,"cell",3,"click"],[3,"piece","white","selected","possibleMove"],[3,"white","reason"]],template:function(t,s){t&1&&(u(0,"div",0)(1,"div",1),E(2,He,2,2,"button",null,T),h(),u(4,"div")(5,"button",2),j("click",function(){return s.restart()}),y(6,"Restart"),h(),u(7,"button",2),j("click",function(){return s.flip=!s.flip}),y(8,"flip board"),h()(),u(9,"div",3),E(10,We,3,0,"div",4,T),h(),M(12,Xe,1,2,"app-game-over"),h(),u(13,"div",5)(14,"h3"),y(15,"Moves:"),h(),u(16,"div",6),E(17,Ye,2,3,"div",null,T),h()()),t&2&&(C(),B("display",s.promoteColumn()!=null?"block":"none")("top",s.whitesTurn()?"":"693px"),C(),I(s.promotePieces),C(8),I(s.board()),C(2),v(12,s.state()!=0?12:-1),C(5),I(s.getPgnSplit()))},dependencies:[pe,me],styles:[".board-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.board[_ngcontent-%COMP%]{border:solid;width:fit-content;border-width:1px}.row[_ngcontent-%COMP%]{display:flex}.cell[_ngcontent-%COMP%]{text-align:center;width:100px;height:100px}.moves-container[_ngcontent-%COMP%]{position:absolute;right:0;top:50px;width:300px}.moves[_ngcontent-%COMP%]{display:grid}.promote[_ngcontent-%COMP%]{position:absolute}"]});let o=i;return o})();var we=(()=>{let i=class i{constructor(){this.title="Chess"}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=x({type:i,selectors:[["app-root"]],standalone:!0,features:[b],decls:3,vars:0,consts:[[1,"title"],[1,"board"]],template:function(t,s){t&1&&(u(0,"h1",0),y(1,"Chess"),h(),f(2,"app-board",1))},dependencies:[Ce],styles:[".title[_ngcontent-%COMP%]{text-align:center}"]});let o=i;return o})();var ge=[];var Ze="@",Je=(()=>{let i=class i{constructor(e,t,s,n,r){this.doc=e,this.delegate=t,this.zone=s,this.animationType=n,this.moduleImpl=r,this._rendererFactoryPromise=null,this.scheduler=H(Z,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-YO324QKJ.mjs")).catch(t=>{throw new q(5300,!1)}).then(({\u0275createEngine:t,\u0275AnimationRendererFactory:s})=>{this._engine=t(this.animationType,this.doc,this.scheduler);let n=new s(this.delegate,this._engine,this.zone);return this.delegate=n,n})}createRenderer(e,t){let s=this.delegate.createRenderer(e,t);if(s.\u0275type===0)return s;typeof s.throwOnSyntheticProps=="boolean"&&(s.throwOnSyntheticProps=!1);let n=new Q(s);return t?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(r=>{let l=r.createRenderer(e,t);n.use(l)}).catch(r=>{n.use(s)}),n}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}};i.\u0275fac=function(t){Y()},i.\u0275prov=_({token:i,factory:i.\u0275fac});let o=i;return o})(),Q=class{constructor(i){this.delegate=i,this.replay=[],this.\u0275type=1}use(i){if(this.delegate=i,this.replay!==null){for(let p of this.replay)p(i);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(i,p){return this.delegate.createElement(i,p)}createComment(i){return this.delegate.createComment(i)}createText(i){return this.delegate.createText(i)}get destroyNode(){return this.delegate.destroyNode}appendChild(i,p){this.delegate.appendChild(i,p)}insertBefore(i,p,e,t){this.delegate.insertBefore(i,p,e,t)}removeChild(i,p,e){this.delegate.removeChild(i,p,e)}selectRootElement(i,p){return this.delegate.selectRootElement(i,p)}parentNode(i){return this.delegate.parentNode(i)}nextSibling(i){return this.delegate.nextSibling(i)}setAttribute(i,p,e,t){this.delegate.setAttribute(i,p,e,t)}removeAttribute(i,p,e){this.delegate.removeAttribute(i,p,e)}addClass(i,p){this.delegate.addClass(i,p)}removeClass(i,p){this.delegate.removeClass(i,p)}setStyle(i,p,e,t){this.delegate.setStyle(i,p,e,t)}removeStyle(i,p,e){this.delegate.removeStyle(i,p,e)}setProperty(i,p,e){this.shouldReplay(p)&&this.replay.push(t=>t.setProperty(i,p,e)),this.delegate.setProperty(i,p,e)}setValue(i,p){this.delegate.setValue(i,p)}listen(i,p,e){return this.shouldReplay(p)&&this.replay.push(t=>t.listen(i,p,e)),this.delegate.listen(i,p,e)}shouldReplay(i){return this.replay!==null&&i.startsWith(Ze)}};function ke(o="animations"){return ee("NgAsyncAnimations"),U([{provide:J,useFactory:(i,p,e)=>new Je(i,p,e,o),deps:[ne,se,te]},{provide:W,useValue:o==="noop"?"NoopAnimations":"BrowserAnimations"}])}var ve={providers:[ce(ge),le(),ke()]};var et={providers:[ae()]},Me=oe(ve,et);var tt=()=>re(we,Me),Ot=tt;export{Ot as a};
